<!DOCTYPE html>
<html lang="bg">
<head>
    <meta charset="UTF-8" />
    <title>–ó–æ–Ω–∏ –∏ –≥–ª–æ–±–∏ –º–µ–∂–¥—É –°–æ—Ñ–∏—è –∏ –ü–ª–æ–≤–¥–∏–≤</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 10px;
            background-image: url('A_looping_two-dimensional_digital_illustration_ani.png');
            background-size: cover;
            background-repeat: no-repeat;
            background-position: center;
            color: white;
            text-shadow: 1px 1px 2px black;
        }
        .zone {
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 15px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.6);
        }
        label, select, input {
            margin: 5px 0;
            display: block;
        }
        button {
            margin-top: 10px;
        }
        h2 {
            border-bottom: 1px solid #fff;
            padding-bottom: 5px;
        }
        #totalResult {
            margin-top: 20px;
            font-size: 18px;
            background-color: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
        }
    </style>
</head>
<body>

    <h1>–ö–∞–ª–∫—É–ª–∞—Ç–æ—Ä –Ω–∞ –∑–æ–Ω–∏ –∏ –≥–ª–æ–±–∏ (–°–æ—Ñ–∏—è - –ü–ª–æ–≤–¥–∏–≤)</h1>
    <p>–†–∞–∑—Å—Ç–æ—è–Ω–∏–µ: 140 –∫–º, –∑–æ–Ω–∏: 7, –≤—Å—è–∫–∞ –∑–æ–Ω–∞ –æ–∫–æ–ª–æ 20 –∫–º.</p>

    <div id="zonesContainer"></div>

    <button onclick="calculateTotal()" style="margin-top:20px; padding:10px 20px; font-size:16px;">üìä –ò–∑—á–∏—Å–ª–∏ –æ–±—â —Ä–µ–∑—É–ª—Ç–∞—Ç</button>
    <div id="totalResult"></div>

    <script>
        const totalDistance = 140;
        const totalZones = 7;
        const zoneLength = totalDistance / totalZones;
        const speedLimits = [30,40,50,60,70,80,90,100,110,120,130,140,150,160];

        function calculateFine(speedExceeded, isUrban) {
            let fine = 0;
            let points = 0;
            let license = "–ë–µ–∑ –æ—Ç–Ω–µ–º–∞–Ω–µ";

            if (speedExceeded <= 0) {
                return { fine: 0, text: "–ù—è–º–∞ –ø—Ä–µ–≤–∏—à–µ–Ω–∏–µ, –Ω—è–º–∞ –≥–ª–æ–±–∞.", points, license };
            }

            if (speedExceeded <= 10) {
                fine = 20; points = 0;
            } else if (speedExceeded <= 20) {
                fine = 50; points = 2;
            } else if (speedExceeded <= 30) {
                fine = 100; points = 4;
            } else if (speedExceeded <= 40) {
                fine = 400; points = 6;
            } else if (speedExceeded <= 50) {
                fine = 600; points = 8;
                license = isUrban ? "3 –º–µ—Å–µ—Ü–∞" : "–ë–µ–∑ –æ—Ç–Ω–µ–º–∞–Ω–µ";
            } else if (speedExceeded <= 60) {
                fine = 700; points = 10;
                license = isUrban ? "6 –º–µ—Å–µ—Ü–∞" : "3 –º–µ—Å–µ—Ü–∞";
            } else {
                fine = 1000; points = 12;
                license = isUrban ? "12 –º–µ—Å–µ—Ü–∞ –∏–ª–∏ –ø–æ–≤–µ—á–µ" : "6 –º–µ—Å–µ—Ü–∞";
            }

            return {
                fine,
                text: `–ì–ª–æ–±–∞: ${fine} –ª–≤.<br>–ö–æ–Ω—Ç—Ä–æ–ª–Ω–∏ —Ç–æ—á–∫–∏: ${points}<br>–û—Ç–Ω–µ–º–∞–Ω–µ –Ω–∞ –°–£–ú–ü–°: ${license}`,
                points,
                license
            };
        }

        function createZoneElement(index) {
            const zoneDiv = document.createElement("div");
            zoneDiv.className = "zone";
            zoneDiv.innerHTML = `
                <h2>–ó–æ–Ω–∞ ${index + 1}</h2>
                <label for="speedLimit${index}">–ò–∑–±–µ—Ä–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç (–∫–º/—á):</label>
                <select id="speedLimit${index}">
                    ${speedLimits.map(s => `<option value="${s}">${s} –∫–º/—á</option>`).join('')}
                </select>
                <label for="actualSpeed${index}">–í—ä–≤–µ–¥–∏ —Ç–≤–æ—è—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç (–∫–º/—á):</label>
                <input type="number" id="actualSpeed${index}" min="0" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä 90" />
                <label for="urban${index}">–ó–æ–Ω–∞ –≤ –Ω–∞—Å–µ–ª–µ–Ω–æ –º—è—Å—Ç–æ?</label>
                <select id="urban${index}">
                    <option value="true">–î–∞</option>
                    <option value="false">–ù–µ</option>
                </select>
                <button onclick="calculateZoneFine(${index})">–ò–∑—á–∏—Å–ª–∏ –≥–ª–æ–±–∞</button>
                <p id="fineResult${index}" style="font-weight:bold; margin-top:10px;"></p>
            `;
            return zoneDiv;
        }

        function calculateZoneFine(index) {
            const speedLimit = parseInt(document.getElementById(`speedLimit${index}`).value);
            const actualSpeed = parseFloat(document.getElementById(`actualSpeed${index}`).value);
            const isUrban = document.getElementById(`urban${index}`).value === "true";
            const fineResult = document.getElementById(`fineResult${index}`);

            if (isNaN(actualSpeed) || actualSpeed < 0) {
                fineResult.innerText = "–ú–æ–ª—è, –≤—ä–≤–µ–¥–∏ –≤–∞–ª–∏–¥–Ω–∞ —Å–∫–æ—Ä–æ—Å—Ç.";
                return;
            }

            const speedExceeded = actualSpeed - speedLimit;
            const fine = calculateFine(speedExceeded, isUrban);
            fineResult.innerHTML = fine.text;
        }

        function parseFineAmount(text) {
            const match = text.match(/–ì–ª–æ–±–∞: (\d+)/);
            return match ? parseInt(match[1]) : 0;
        }

        function calculateTotal() {
            let totalFine = 0;
            let totalPoints = 0;
            let banDurations = ["–ë–µ–∑ –æ—Ç–Ω–µ–º–∞–Ω–µ", "3 –º–µ—Å–µ—Ü–∞", "6 –º–µ—Å–µ—Ü–∞", "12 –º–µ—Å–µ—Ü–∞ –∏–ª–∏ –ø–æ–≤–µ—á–µ"];
            let maxBanIndex = 0;

            for (let i = 0; i < totalZones; i++) {
                const fineText = document.getElementById(`fineResult${i}`).innerText || "";
                totalFine += parseFineAmount(fineText);

                const pointMatch = fineText.match(/–ö–æ–Ω—Ç—Ä–æ–ª–Ω–∏ —Ç–æ—á–∫–∏: (\d+)/);
                if (pointMatch) totalPoints += parseInt(pointMatch[1]);

                const banMatch = fineText.match(/–û—Ç–Ω–µ–º–∞–Ω–µ –Ω–∞ –°–£–ú–ü–°: (.+)/);
                if (banMatch) {
                    const ban = banMatch[1].trim();
                    const idx = banDurations.indexOf(ban);
                    if (idx > maxBanIndex) maxBanIndex = idx;
                }
            }

            const resultText = `
                üßæ –û–±—â–∞ –≥–ª–æ–±–∞: <strong>${totalFine} –ª–≤.</strong><br>
                üìç –û–±—â–æ –æ—Ç–Ω–µ—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª–Ω–∏ —Ç–æ—á–∫–∏: <strong>${totalPoints}</strong><br>
                üö´ –ù–∞–π-–¥—ä–ª–≥–æ –æ—Ç–Ω–µ–º–∞–Ω–µ –Ω–∞ –∫–Ω–∏–∂–∫–∞: <strong>${banDurations[maxBanIndex]}</strong>
            `;
            document.getElementById("totalResult").innerHTML = resultText;
        }

        function createZones() {
            const container = document.getElementById("zonesContainer");
            container.innerHTML = "";
            for (let i = 0; i < totalZones; i++) {
                container.appendChild(createZoneElement(i));
            }
        }

        createZones();
    </script>

</body>
</html>
